<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="theme-color" content="#3F51B5">

    <title>ROS Data Waster</title>
    <meta name="description" content="The most straightforward way to waste all of your data.">

    <link rel="shortcut icon" href="favicon.ico">

    <link rel="stylesheet" href="https://unpkg.com/material-components-web@0.43.1/dist/material-components-web.min.css">

    <style>
        :root {
            --mdc-theme-primary: #3f51b5;
            --mdc-theme-secondary: #f44336;
            --mdc-theme-on-primary: #ffffff;
            --mdc-theme-on-secondary: #ffffff;
        }
        
        :root body {
            background-color: #fafafa;
        }
        
        :root body .ribbon {
            top: 0;
            z-index: -1;
            background-color: #3f51b5;
            width: 100%;
            height: 10rem;
            position: absolute;
        }
        
        :root body .main-content {
            background-color: #ffffff;
            border-radius: 4px;
            margin: 20px;
            padding: 20px;
            min-height: calc(100vh - 80px);
        }
        
        :root body .main-content .option--mbs {
            width: 100%;
        }
        
        :root body .main-content label[for="option--unlimited-input"],
        :root body .main-content label[for="option--precise-input"] {
            margin-left: 10px;
        }
        
        :root body .output--progress {
            bottom: 0px;
            height: 8px;
            position: fixed;
        }
    </style>

    <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Roboto:300,400,500'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />

</head>

<body>
    <div class="ribbon mdc-elevation--z4"></div>
    <main class="main-content mdc-typography mdc-elevation--z8">
        <h1 class="mdc-typography--headline2">ROS Data Waster</h1>
        <p class="mdc-typography--body1">The most straightforward way to waste all of your data.</p>
        <div class="option--unlimited mdc-switch mdc-switch--checked" data-mdc-auto-init="MDCSwitch">
            <div class="mdc-switch__track"></div>
            <div class="mdc-switch__thumb-underlay">
                <div class="mdc-switch__thumb">
                    <input type="checkbox" id="option--unlimited-input" class="mdc-switch__native-control" role="switch" checked>
                </div>
            </div>
        </div>
        <label for="option--unlimited-input">Waste Unlimited Data</label>
        <br>
        <br>
        <div class="option--precise mdc-switch" data-mdc-auto-init="MDCSwitch">
            <div class="mdc-switch__track"></div>
            <div class="mdc-switch__thumb-underlay">
                <div class="mdc-switch__thumb">
                    <input type="checkbox" id="option--precise-input" class="mdc-switch__native-control" role="switch">
                </div>
            </div>
        </div>
        <label for="option--precise-input">Precise Wasting</label>
        <br>
        <br>
        <div class="option--mbs mdc-text-field mdc-text-field--outlined mdc-text-field--disabled" data-mdc-auto-init="MDCTextField">
            <input type="number" min="1" id="goal" value="1" class="mdc-text-field__input">
            <div class="mdc-notched-outline">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                    <label for="goal" class="mdc-floating-label">MBs of data to waste</label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
            </div>
        </div>
        <br>
        <br>
        <button class="option--waste waste-button mdc-fab mdc-fab--extended" data-mdc-auto-init="MDCRipple">

            <svg class="mdc-fab__icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="none" d="M0 0h24v24H0V0z" />
                <path d="M10 8.64L15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z" />
            </svg>
            <span class="mdc-fab__label">Start Wasting</span>
        </button>

        <p class="mdc-typography--body1">
            Megabytes wasted: <span class="output--byte">0</span>
        </p>
        <p class="mdc-typography--body1">
            Megabytes wasted per second: <span class="output--speed">0</span>
        </p>

        <div class="snackbar--limit mdc-snackbar mdc-snackbar--leading" data-mdc-auto-init="MDCSnackbar">
            <div class="mdc-snackbar__surface">
                <div class="mdc-snackbar__label" role="status" aria-live="polite">
                    Data wasted reached internal limit.
                </div>
            </div>
        </div>
        <div class="snackbar--done mdc-snackbar mdc-snackbar--leading" data-mdc-auto-init="MDCSnackbar">
            <div class="mdc-snackbar__surface">
                <div class="mdc-snackbar__label" role="status" aria-live="polite">
                    The specified amount of data was wasted.
                </div>
            </div>
        </div>

    </main>
    <div role="progressbar" class="output--progress mdc-linear-progress mdc-linear-progress--indeterminate mdc-linear-progress--closed" data-mdc-auto-init="MDCLinearProgress">
        <div class="mdc-linear-progress__buffering-dots"></div>
        <div class="mdc-linear-progress__buffer"></div>
        <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
            <span class="mdc-linear-progress__bar-inner"></span>
        </div>
        <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
            <span class="mdc-linear-progress__bar-inner"></span>
        </div>
    </div>

    <script async src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <script src="https://unpkg.com/material-components-web@0.43.1/dist/material-components-web.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script>
        mdc.autoInit();

        var running = false;
        var wasted = 0;
        var xhr = [];
        var threads = 8;
        var time = 0;
        var goal = 0;
        var chunk = 800000;
        var v = 2;
        var int = null;
        var stopped = false;
        var speed = 0;
        var url = "";

        function getmbs() {
            return document.querySelector(".option--unlimited").MDCSwitch.checked === true ?
                0 :
                parseInt(document.querySelector(".option--mbs").MDCTextField.value);
        }

        function download(id) {
            if (xhr[id] && xhr[id].status == 200) {
                wasted += chunk;
                $(".output--byte").html((0 | wasted * 100 / 1048576) / 100);
                speed = wasted / (new Date().getTime() - time) * 1000;
                speed = (0 | speed * 100 / 1048576) / 100;
                $(".output--speed").html(speed);
                if (
                    getmbs() !== 0 &&
                    parseInt($(".output--byte").html()) /
                    parseInt(document.querySelector(".option--mbs").MDCTextField.value) <
                    1.0) {
                    document.querySelector(".output--progress").MDCLinearProgress.progress =
                        parseInt($(".output--byte").html()) /
                        parseInt(document.querySelector(".option--mbs").MDCTextField.value);
                } else {
                    document.querySelector(
                        ".output--progress").
                    MDCLinearProgress.progress = 1.0;
                }
                if (wasted >= 1048576 * 1024 * 100) {
                    document.querySelector(".snackbar--limit").MDCSnackbar.open();
                    stop();
                } else if (goal !== 0 && wasted >= goal * 1048576) {
                    document.querySelector(".snackbar--done").MDCSnackbar.open();
                    stop();
                }
            }
            if (running == true) {
                url = "https://ros-static.ga/public/ros-data-waster-dummy?" + Math.random();
                xhr[id] = $.get(url, function() {
                    download(id);
                });
            }
        }

        function stop() {
            running = false;
            document.querySelector(
                ".option--mbs").
            MDCTextField.disabled = document.querySelector(
                ".option--unlimited").
            MDCSwitch.checked;
            document.querySelector(".option--unlimited").MDCSwitch.disabled = false;
            document.querySelector(".option--precise").MDCSwitch.disabled = false;
            document.querySelector(".output--progress").MDCLinearProgress.close();
            $(".option--waste > .mdc-fab__label").html("Start Wasting");
            $(".option--waste > .mdc-fab__icon").html(
                '<path fill="none" d="M0 0h24v24H0V0z"/><path d="M10 8.64L15.27 12 10 15.36V8.64M8 5v14l11-7L8 5z"/>');

        }

        function start() {
            threads = document.querySelector(".option--precise").MDCSwitch.checked ?
                1 :
                8;
            document.querySelector(".output--progress").MDCLinearProgress.progress = 0.0;
            document.querySelector(".option--mbs").MDCTextField.disabled = true;
            document.querySelector(".option--unlimited").MDCSwitch.disabled = true;
            document.querySelector(".option--precise").MDCSwitch.disabled = true;
            document.querySelector(".option--unlimited").MDCSwitch.disabled = true;
            document.querySelector(".output--progress").MDCLinearProgress.determinate =
                getmbs() !== 0;
            document.querySelector(".output--progress").MDCLinearProgress.open();
            $(".option--waste > .mdc-fab__label").html("Stop Wasting");
            $(".option--waste > .mdc-fab__icon").html(
                '<path fill="none" d="M0 0h24v24H0V0z"/><path d="M16 8v8H8V8h8m2-2H6v12h12V6z"/>');

            running = true;
            wasted = 0;
            xhr = [];
            time = new Date().getTime();
            goal = getmbs();
            for (var i = 0; i < threads; i++) {
                download(i);
            }
        }

        document.querySelector(".option--unlimited").MDCSwitch.listen("change", function() {
            var on = document.querySelector(".option--unlimited").MDCSwitch.checked;
            document.querySelector(".option--mbs").MDCTextField.disabled = on;
            document.querySelector(".option--mbs").MDCTextField.required = !on;
            document.querySelector(
                ".output--progress").
            MDCLinearProgress.determinate = !on;
        });

        $(".option--waste").on("click", function() {
            if (running === false && stopped === false) {
                start();
            } else if (stopped === false) {
                stop();
            }
        });
    </script>

</body>

</html>
